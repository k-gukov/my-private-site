<!DOCTYPE html>
<html class="loading" dir="ltr">
  <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>2.2.3.1 Файлы конфигурации</title>
    <!-- Content -->
    <link rel="stylesheet" type="text/css" href="../../common-ext/styles/page.css"/>
    <script type="text/javascript" src="../../common-ext/scripts/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/permission.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/page.js"></script>
    <script type="text/javascript" src="media/override.js"></script>
    <script>
      var media_transcript_file = "media_2.2.3.1_longdesc.txt";
    </script>
  </head>
  <body>
    <div id="media-container">
      <iframe id="media" alt="interactive graphic"></iframe>
    </div>
    <div id="text-container">
      <div id="text">
        <h1>Файлы конфигурации</h1>
        <div>
<p>Файл текущей конфигурации отражает текущую конфигурацию, функционирующую на устройстве CISCO IOS. Он содержит команды, используемые для определения принципов работы устройства в сети, как показано на рисунке 1. Изменения текущей конфигурации незамедлительно влияют на работу устройства Cisco. </p>
<p></p>
<p>Файл текущей конфигурации хранится в рабочей памяти устройства или в оперативном запоминающем устройстве (ОЗУ). Это означает, что файл текущей конфигурации временно активен, когда работает устройство Cisco (подключено к питанию). Однако при отключении питания устройства или перезапуске устройства все несохранённые изменения конфигурации будут потеряны.</p>
<p></p>
<p>После внесения изменений в файл текущей конфигурации следует рассмотреть следующие варианты действий. </p>
<p></p>
<p>
<ul>
<li>Вернуть устройство к исходной конфигурации.</li>
</ul>
</p>
<p>
<ul>
<li>Удалить все внесённые изменения.</li>
</ul>
</p>
<p>
<ul>
<li>Сделать изменённую конфигурацию новой начальной конфигурацией. </li>
</ul>
</p>
<p></p>
<p>Файл загрузочной конфигурации отображает конфигурацию, которая будет применена на устройстве после перезагрузки. Файл загрузочной конфигурации хранится в энергонезависимой памяти (NVRAM). После настройки сетевого устройства и изменения текущей конфигурации важно сохранить эти изменения в файл загрузочной конфигурации. Это предотвращает потери изменений вследствие сбоя питания или случайной перезагрузки. </p>
<p></p>
<p>Перед внесением изменений воспользуйтесь соответствующими командами <span class="cmd"><b>show</b></span> для проверки работоспособности устройства. Как показано на рисунке, команду <span class="cmd"><b>show running-config</b></span> можно использовать для просмотра файла текущей конфигурации. Когда изменения проверены, используйте команду <span class="cmd"><b>copy running-config startup-config</b></span> в командной строке привилегированного режима. Команда для сохранения файла текущей конфигурации в файл загрузочной конфигурации выглядит так:</p>
<p></p>
<p>
<span class="cmd">Switch#</span>
<span class="cmd">
<b>copy running-config startup-config</b>
</span>
</p>
<p></p>
<p>После выполнения команды файл текущей конфигурации обновляет файл загрузочной конфигурации.</p>
<p></p>
<p>Если изменения, внесённые в ходе конфигурации, не принесли желаемого результата, возможно, понадобится восстановить предыдущую конфигурацию устройства. Если мы не переписывали начальную конфигурацию с изменениями, текущую конфигурацию можно заменить начальной. Лучше всего это осуществляется путём перезапуска устройства и ввода команды <span class="cmd"><b>reload</b></span> в командной строке привилегированного режима. </p>
<p></p>
<p>Выполняя перезагрузку, IOS определит, что изменённая конфигурация не была сохранена в файл начальной конфигурации. IOS запросит, нужно ли сохранить изменения. Для отмены изменений введите <span class="cmd"><b>n</b></span> или <span class="cmd"><b>no</b></span>.</p>
<p></p>
<p>Для подтверждения перезагрузки появится дополнительный запрос. Для подтверждения нажмите Enter. Нажатие любой другой клавиши приведёт к преждевременному завершению данного процесса.</p>
<p></p>
<p>Например:</p>
<p></p>
<p>
<span class="cmd">Switch#</span>
<span class="cmd">
<b>reload</b>
</span>
</p>
<p>
<span class="cmd">System configuration has been modified. Save? [yes/no]: </span>
<span class="cmd">
<b>n</b>
</span>
</p>
<p>
<span class="cmd">Proceed with reload? [confirm]</span>
</p>
<p>
<span class="cmd">*Apr 13 01:34:15.758: %SYS-5-RELOAD: Reload requested by console. Reload Reason:</span>
</p>
<p>
<span class="cmd">Reload Command.</span>
</p>
<p>
<span class="cmd">System Bootstrap, Version 12.3(8r)T8, RELEASE SOFTWARE (fc1)</span>
</p>
<p>
<span class="cmd">Technical Support: http://www.cisco.com/techsupport</span>
</p>
<p>
<span class="cmd">Copyright (c) 2004 by cisco Systems, Inc.</span>
</p>
<p>
<span class="cmd">PLD version 0x10</span>
</p>
<p>
<span class="cmd">GIO ASIC version 0x127</span>
</p>
<p>
<span class="cmd">c1841 platform with 131072 Kbytes of main memory</span>
</p>
<p>
<span class="cmd">Main memory is configured to 64 bit mode with parity disabled</span>
</p>
<p></p>
<p></p>
<p>Если нежелательные изменения сохранены в файл начальной конфигурации, возможно, понадобится очистить все конфигурации. Для этого нужно удалить начальную конфигурацию и перезапустить устройство.</p>
<p></p>
<p>Начальную конфигурацию можно удалить с помощью команды <span class="cmd"><b>erase startup-config</b></span>. </p>
<p></p>
<p>Чтобы удалить файл загрузочной конфигурации, введите команды <span class="cmd"><b>erase NVRAM: startup-config</b></span> или <span class="cmd"><b>erase startup-config</b></span> в командную строку привилегированного режима: </p>
<p></p>
<p>
<span class="cmd">Switch#</span>
<span class="cmd">
<b>erase startup-config</b>
</span>
</p>
<p></p>
<p>После ввода команды появится запрос о подтверждении:</p>
<p></p>
<p>
<span class="cmd">Erasing the nvram filesystem will remove all configuration files! Continue? [confirm]</span>
</p>
<p></p>
<p>Ответ по умолчанию — «Подтверждаю». Для подтверждения и удаления файла загрузочной конфигурации нажмите клавишу Enter. Нажатие любой другой клавиши приведёт к преждевременному завершению данного процесса.</p>
<p></p>
<p>
<b>Внимание</b>. Будьте внимательны при использовании команды <span class="cmd"><b>erase</b></span>. Эту команду можно использовать для удаления любого файла в устройстве. Неправильное использование этой команды может привести к удалению самой IOS или других важных файлов.</p>
<p></p>
<p>Кроме того, на коммутаторе необходимо выполнить команду <span class="cmd"><b>delete vlan.dat</b></span> в дополнение к команде <span class="cmd"><b>erase startup-config</b></span>, чтобы вернуть конфигурацию, «встроенную» по умолчанию (соответствующую установленной на предприятии):</p>
<p></p>
<p>
<span class="cmd">Switch#</span>
<span class="cmd">
<b>delete vlan.dat</b>
</span>
<span class="cmd"></span>
</p>
<p>
<span class="cmd">Delete filename [vlan.dat]? </span>
</p>
<p>
<span class="cmd">Delete flash:vlan.dat? [confirm]</span>
</p>
<p>
<span class="cmd">Switch#</span>
<span class="cmd">
<b>erase startup-config</b>
</span>
</p>
<p>
<span class="cmd">Erasing the nvram filesystem will remove all configuration files! Continue? [confirm]</span>
</p>
<p>
<span class="cmd">[OK]</span>
</p>
<p>
<span class="cmd">Erase of nvram: complete</span>
</p>
<p>
<span class="cmd">Switch#</span>
</p>
<p></p>
<p>После удаления начальной конфигурации из NVRAM (и удаления файла vlan.dat из коммутатора) перезапустите устройство, чтобы удалить файл текущей конфигурации из ОЗУ. Затем устройство загрузит файл начальной конфигурации, встроенной по умолчанию, в текущую конфигурацию.</p>
<p></p>
<p>На рисунке 2 отработайте ввод команд для сохранения текущей конфигурации из ОЗУ в NVRAM.</p>
</div>
      </div>
      <div id="text-handle" title="Изменить размер"></div>
    </div>
    <div id="login">Для получения доступа к этому курсу войдите в систему <a href="http://netacad.com">netacad.com</a>.</div>
  </body>
</html>
